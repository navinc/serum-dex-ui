(this["webpackJsonpserum-dex-ui"]=this["webpackJsonpserum-dex-ui"]||[]).push([[0],{255:function(e,t,n){e.exports=n.p+"static/media/logo.49174c73.svg"},262:function(e,t,n){e.exports=n(450)},267:function(e,t,n){},268:function(e,t,n){},272:function(e,t){},273:function(e,t){},450:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(25),o=n.n(c),i=(n(267),n(268),n(10)),l=n.n(i),u=n(24),s=n(11),d=n(75),m=n(36);function f(e){if(!e)return!1;try{return new m.PublicKey(e),!0}catch(t){return!1}}function p(e){return b.apply(this,arguments)}function b(){return(b=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=new Intl.NumberFormat(void 0,{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2});function k(e,t){return t?Math.floor(e*Math.pow(10,t))/Math.pow(10,t):e}function h(e,t){return t?Math.round(e*Math.pow(10,t))/Math.pow(10,t):e}function g(e){return isNaN(e)||Math.floor(e)===e?0:e.toString().split(".")[1].length||0}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(r.useState)((function(){var n=localStorage.getItem(e);return n?JSON.parse(n):t})),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useCallback)((function(t){c!==t&&(o(t),null===t?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t)))}),[c,e]);return[c,i]}function O(e,t,n){if(!n&&Object.keys(e).length!==Object.keys(t).length)return!1;n=n||Object.keys(e);var r,a=Object(d.a)(n);try{for(a.s();!(r=a.n()).done;){var c=r.value;if(e[c]!==t[c])return!1}}catch(o){a.e(o)}finally{a.f()}return!0}var E=n(60),x=n(98),w=n(93),j=n(13),S=n.n(j),T=new Date,C=new Map,A=function e(t,n,r,a,c){Object(w.a)(this,e),this.cacheKey=t,this.fn=n,this.refreshInterval=r,this.refreshIntervalOnError=a,this.callback=c},M=function(){function e(t,n){var r=this;Object(w.a)(this,e),this.refresh=Object(u.a)(l.a.mark((function e(){var t,n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.timeoutId&&(clearTimeout(r.timeoutId),r.timeoutId=null),!r.stopped){e.next=3;break}return e.abrupt("return");case 3:return t=!1,e.prev=4,e.next=7,r.fn();case 7:return n=e.sent,C.set(r.cacheKey,n),r.errors=0,r.notifyListeners(),e.abrupt("return",n);case 14:e.prev=14,e.t0=e.catch(4),++r.errors,console.warn(e.t0),t=!0;case 19:return e.prev=19,r.timeoutId||r.stopped||(a=r.refreshInterval,t&&r.refreshIntervalOnError&&r.refreshIntervalOnError>0&&(a=r.refreshIntervalOnError),r.errors>0&&(a=Math.min(1e3*Math.pow(2,r.errors-1),6e4)),(c=new Date-T)<5e3&&(a+=5e3-c/2),"hidden"===document.visibilityState?a=6e4:document.hasFocus()||(a*=1.5),a*=.8+.4*Math.random(),r.timeoutId=setTimeout(r.refresh,a)),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,14,19,22]])}))),this.cacheKey=t,this.fn=n,this.timeoutId=null,this.listeners=new Set,this.errors=0}return Object(x.a)(e,[{key:"addListener",value:function(e){var t=this.refreshInterval;this.listeners.add(e),this.refreshInterval<t&&this.refresh()}},{key:"removeListener",value:function(e){S()(this.listeners.delete(e)),this.stopped&&this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}},{key:"notifyListeners",value:function(){this.listeners.forEach((function(e){return e.callback()}))}},{key:"refreshInterval",get:function(){return Math.min.apply(Math,Object(E.a)(Object(E.a)(this.listeners).map((function(e){return e.refreshInterval}))))}},{key:"refreshIntervalOnError",get:function(){return Math.min.apply(Math,Object(E.a)(Object(E.a)(this.listeners).map((function(e){return e.refreshIntervalOnError})).filter((function(e){return e}))))}},{key:"stopped",get:function(){return 0===this.listeners.size}}]),e}(),I=new(function(){function e(){Object(w.a)(this,e),this.loops=new Map}return Object(x.a)(e,[{key:"addListener",value:function(e){this.loops.has(e.cacheKey)||this.loops.set(e.cacheKey,new M(e.cacheKey,e.fn)),this.loops.get(e.cacheKey).addListener(e)}},{key:"removeListener",value:function(e){var t=this.loops.get(e.cacheKey);t.removeListener(e),t.stopped&&this.loops.delete(e.cacheKey)}},{key:"refresh",value:function(e){this.loops.has(e)&&this.loops.get(e).refresh()}},{key:"refreshAll",value:function(){return Promise.all(Object(E.a)(this.loops.values()).map((function(e){return e.refresh()})))}}]),e}());function z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.refreshInterval,c=void 0===a?6e4:a,o=n.refreshIntervalOnError,i=void 0===o?null:o,l=Object(r.useReducer)((function(e){return e+1}),0),u=Object(s.a)(l,2),d=u[1];if(Object(r.useEffect)((function(){if(!t)return function(){};var n=new A(t,e,c,i,d);return I.addListener(n),function(){return I.removeListener(n)}}),[t,c]),!t)return[null,!1];var m=C.has(t),f=m?C.get(t):void 0;return[f,m]}function N(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&C.delete(e);var n=I.loops.get(e);n&&(n.refresh(),t&&n.notifyListeners())}var B=n(62),F=[{name:"mainnet-beta",endpoint:"https://solana-api.projectserum.com"},{name:"testnet",endpoint:Object(m.clusterApiUrl)("testnet")},{name:"devnet",endpoint:Object(m.clusterApiUrl)("devnet")},{name:"localnet",endpoint:"http://127.0.0.1:8899"}],P=new Map,q=a.a.createContext(null);function K(e){var t=e.children,n=y("connectionEndpts",F[0].endpoint),c=Object(s.a)(n,2),o=c[0],i=c[1],l=Object(r.useMemo)((function(){return new m.Connection(o,"recent")}),[o]),u=Object(r.useMemo)((function(){return new m.Connection(o,"recent")}),[o]);return Object(r.useEffect)((function(){var e=l.onAccountChange((new m.Account).publicKey,(function(){}));return function(){return l.removeAccountChangeListener(e)}}),[l]),Object(r.useEffect)((function(){var e=l.onSlotChange((function(){return null}));return function(){return l.removeSlotChangeListener(e)}}),[l]),Object(r.useEffect)((function(){var e=u.onAccountChange((new m.Account).publicKey,(function(){}));return function(){return u.removeAccountChangeListener(e)}}),[u]),Object(r.useEffect)((function(){var e=u.onSlotChange((function(){return null}));return function(){return u.removeSlotChangeListener(e)}}),[u]),a.a.createElement(q.Provider,{value:{endpoint:o,setEndpoint:i,connection:l,sendConnection:u}},t)}function R(){return Object(r.useContext)(q).connection}function L(){return Object(r.useContext)(q).sendConnection}function D(){var e=Object(r.useContext)(q);return{endpoint:e.endpoint,setEndpoint:e.setEndpoint}}function W(e){var t=R(),n=Object(B.a)(t,null===e||void 0===e?void 0:e.toBase58()),a=z(Object(u.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e?t.getAccountInfo(e):null);case 1:case"end":return n.stop()}}),n)}))),n,{refreshInterval:6e4}),c=Object(s.a)(a,2),o=c[0],i=c[1];return Object(r.useEffect)((function(){if(e){if(P.has(n)){++P.get(n).count}else{var r=null,a=t.onAccountChange(e,(function(e){e.data&&(r&&r.equals(e.data)||function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.initializeOnly,a=void 0!==r&&r;if(!a||!C.has(e)){C.set(e,t);var c=I.loops.get(e);c&&c.notifyListeners()}}(n,e),r=e.data)}));P.set(n,{count:1,subscriptionId:a})}return function(){var e=P.get(n);e.count-1<=0?(t.removeAccountChangeListener(e.subscriptionId),P.delete(n)):--e.count}}}),[n]),[o,i]}function U(e){var t=W(e),n=Object(s.a)(t,1)[0];return n&&n.data}var _=n(32),H=n(40),J=n(226),Q=n(260);function Y(e){var t=e.message,n=e.description,r=e.type,c=void 0===r?"info":r,o=e.placement,i=void 0===o?"bottomLeft":o;Q.a[c]({message:a.a.createElement("span",{style:{color:"black"}},t),description:a.a.createElement("span",{style:{color:"black",opacity:.5}},n),placement:i,style:{backgroundColor:"white"}})}var G=[{name:"sollet.io",url:"https://www.sollet.io"}],X=a.a.createContext(null);function V(e){var t,n,c=e.children,o=D().endpoint,i=y("walletProvider","https://www.sollet.io"),l=Object(s.a)(i,2),u=l[0],d=l[1],m=Object(r.useMemo)((function(){return new J.a(u,o)}),[u,o]),f=Object(r.useState)(!1),p=Object(s.a)(f,2),b=p[0],v=p[1];return Object(r.useEffect)((function(){return console.log("trying to connect"),m.on("connect",(function(){console.log("connected"),v(!0);var e=m.publicKey.toBase58();Y({message:"Wallet update",description:"Connected to wallet "+(e.length>20?"".concat(e.substring(0,7),".....").concat(e.substring(e.length-7,e.length)):e)})})),m.on("disconnect",(function(){v(!1),Y({message:"Wallet update",description:"Disconnected from wallet"})})),function(){m.disconnect(),v(!1)}}),[m]),a.a.createElement(X.Provider,{value:{wallet:m,connected:b,providerUrl:u,setProviderUrl:d,providerName:null!==(t=null===(n=G.find((function(e){return e.url===u})))||void 0===n?void 0:n.name)&&void 0!==t?t:u}},c)}function Z(){var e=Object(r.useContext)(X);return{connected:e.connected,wallet:e.wallet,providerUrl:e.providerUrl,setProvider:e.setProviderUrl,providerName:e.providerName}}var $=n(79),ee=n(7),te=n(53),ne=n.n(te),re=n(107),ae=ee.struct([ee.blob(32,"mint"),ee.blob(32,"owner"),ee.nu64("amount"),ee.blob(93)]);function ce(e){var t=ae.decode(e),n=t.mint,r=t.owner,a=t.amount;return{mint:new m.PublicKey(n),owner:new m.PublicKey(r),amount:a}}function oe(e){return[{memcmp:{offset:ae.offsetOf("owner"),bytes:e.toBase58()}},{dataSize:ae.span}]}var ie=new m.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");function le(e,t){return ue.apply(this,arguments)}function ue(){return(ue=Object(u.a)(l.a.mark((function e(t,n){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe(n),e.next=3,t._rpcRequest("getProgramAccounts",[ie.toBase58(),{commitment:t.commitment,filters:r}]);case 3:if(!(a=e.sent).error){e.next=6;break}throw new Error("failed to get token accounts owned by "+n.toBase58()+": "+a.error.message);case 6:return e.abrupt("return",a.result.map((function(e){var t=e.pubkey,n=e.account,r=n.data,a=n.executable,c=n.owner,o=n.lamports;return{publicKey:new m.PublicKey(t),accountInfo:{data:ne.a.decode(r),executable:a,owner:new m.PublicKey(c),lamports:o}}})).filter((function(e){var t=e.accountInfo;return r.every((function(e){if(e.dataSize)return t.data.length===e.dataSize;if(e.memcmp){var n=ne.a.decode(e.memcmp.bytes);return t.data.slice(e.memcmp.offset,e.memcmp.offset+n.length).equals(n)}return!1}))})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e,t){return de.apply(this,arguments)}function de(){return(de=Object(u.a)(l.a.mark((function e(t,n){var r,a,c,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([le(t,n),t.getAccountInfo(n)]);case 2:return r=e.sent,a=Object(s.a)(r,2),c=a[0],o=a[1],i=c.map((function(e){var t=e.publicKey,n=e.accountInfo;return{pubkey:t,account:n,effectiveMint:ce(n.data).mint}})),e.abrupt("return",i.concat({pubkey:n,account:o,effectiveMint:re.WRAPPED_SOL_MINT}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me=H.MARKETS;function fe(){var e=R(),t=Object(r.useState)([]),n=Object(s.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){(function(){var t=Object(u.a)(l.a.mark((function t(){var n,r,a,o,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],a=Object(d.a)(me),t.prev=2,a.s();case 4:if((o=a.n()).done){t.next=18;break}return r=o.value,t.prev=6,t.next=9,H.Market.load(e,r.address,{},r.programId);case 9:i=t.sent,n.push({market:i,marketName:r.name}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(6),Y({message:"Error loading all market",description:t.t0.message,type:"error"});case 16:t.next=4;break;case 18:t.next=23;break;case 20:t.prev=20,t.t1=t.catch(2),a.e(t.t1);case 23:return t.prev=23,a.f(),t.finish(23);case 26:c(n);case 27:case"end":return t.stop()}}),t,null,[[2,20,23,26],[6,13]])})));return function(){return t.apply(this,arguments)}})()()}),[e]),a}function pe(){var e,t=R(),n=Z().wallet;function r(){return(r=Object(u.a)(l.a.mark((function e(){var r,a,c,o,i,u,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&t&&n.publicKey){e.next=2;break}return e.abrupt("return",[]);case 2:console.log("refreshing useUnmigratedOpenOrdersAccounts"),r=[],a=Array.from(new Set(me.filter((function(e){return e.deprecated})).map((function(e){return e.programId.toBase58()})))).map((function(e){return new m.PublicKey(e)})),o=Object(d.a)(a),e.prev=6,o.s();case 8:if((i=o.n()).done){e.next=22;break}return c=i.value,e.prev=10,e.next=13,H.OpenOrders.findForOwner(t,n.publicKey,c);case 13:u=e.sent,r=r.concat(u.filter((function(e){return e.baseTokenTotal.toNumber()||e.quoteTokenTotal.toNumber()})).filter((function(e){return me.some((function(t){return t.deprecated&&t.address.equals(e.market)}))}))),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),console.log("Error loading deprecated markets",null===(s=c)||void 0===s?void 0:s.toBase58(),e.t0.message);case 20:e.next=8;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(6),o.e(e.t1);case 27:return e.prev=27,o.f(),e.finish(27);case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e,null,[[6,24,27,30],[10,17]])})))).apply(this,arguments)}var a=Object(B.a)("getUnmigratedOpenOrdersAccounts",t,null===n||void 0===n||null===(e=n.publicKey)||void 0===e?void 0:e.toBase58()),c=z((function(){return r.apply(this,arguments)}),a,{refreshInterval:ve});return{accounts:Object(s.a)(c,1)[0],refresh:function(e){return N(a,e)}}}var be=a.a.createContext(null),ve=5e6,ke=me.find((function(e){var t=e.name,n=e.deprecated;return"SRM/USDT"===t&&!n}));function he(e,t){var n,r;if(!e)return{};var a=Ke(t).find((function(t){return t.address.equals(e.address)})),c=(null===e||void 0===e?void 0:e.baseMintAddress)&&(null===(n=H.TOKEN_MINTS.find((function(t){return t.address.equals(e.baseMintAddress)})))||void 0===n?void 0:n.name)||(null===a||void 0===a?void 0:a.baseLabel)&&"".concat(null===a||void 0===a?void 0:a.baseLabel,"*")||"UNKNOWN",o=(null===e||void 0===e?void 0:e.quoteMintAddress)&&(null===(r=H.TOKEN_MINTS.find((function(t){return t.address.equals(e.quoteMintAddress)})))||void 0===r?void 0:r.name)||(null===a||void 0===a?void 0:a.quoteLabel)&&"".concat(null===a||void 0===a?void 0:a.quoteLabel,"*")||"UNKNOWN";return Object(_.a)(Object(_.a)({},a),{},{marketName:null===a||void 0===a?void 0:a.name,baseCurrency:c,quoteCurrency:o,marketInfo:a})}function ge(e){var t=e.children,n=y("marketAddress",ke.address.toBase58()),c=Object(s.a)(n,2),o=c[0],i=c[1],l=y("customMarkets",[]),u=Object(s.a)(l,2),d=u[0],f=u[1],p=new m.PublicKey(o),b=R(),v=Ke(d).find((function(e){return e.address.equals(p)}));Object(r.useEffect)((function(){v&&v.deprecated&&(console.log("Switching markets from deprecated",v),i(ke.address.toBase58()))}),[]);var k=Object(r.useState)(),h=Object(s.a)(k,2),g=h[0],O=h[1];return Object(r.useEffect)((function(){var e;g&&v&&(null===(e=g._decoded.ownAddress)||void 0===e?void 0:e.equals(null===v||void 0===v?void 0:v.address))||(O(null),v&&v.address?H.Market.load(b,v.address,{},v.programId).then(O).catch((function(e){return Y({message:"Error loading market",description:e.message,type:"error"})})):Y({message:"Error loading market",description:"Please select a market from the dropdown",type:"error"}))}),[b,v]),a.a.createElement(be.Provider,{value:Object(_.a)(Object(_.a)({market:g},he(g,d)),{},{setMarketAddress:i,customMarkets:d,setCustomMarkets:f})},t)}function ye(){return Object(r.useContext)(be)}function Oe(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],a=t[1],c=we(),o=Object(s.a)(c,1)[0],i=Ne();return Object(r.useEffect)((function(){var e,t,n=(null===o||void 0===o||null===(e=o.bids)||void 0===e?void 0:e.length)>0&&Number(o.bids[0][0]),r=(null===o||void 0===o||null===(t=o.asks)||void 0===t?void 0:t.length)>0&&Number(o.asks[0][0]),c=(null===i||void 0===i?void 0:i.length)>0&&i[0].price,l=n&&r?c?[n,r,c].sort((function(e,t){return e-t}))[1]:(n+r)/2:null;a(l)}),[o,i]),n}function Ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=ye(),n=t.market,r=R();function a(){return c.apply(this,arguments)}function c(){return(c=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n&&r){t.next=2;break}return t.abrupt("return",null);case 2:return t.next=4,n.loadFills(r,e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var o=z(a,Object(B.a)("getUnfilteredTrades",n,r),{refreshInterval:5e3}),i=Object(s.a)(o,1),d=i[0];return d}function xe(){var e=ye().market,t=U(e&&e._decoded.bids),n=U(e&&e._decoded.asks);return{bidOrderbook:t?H.Orderbook.decode(e,t):null,askOrderbook:n?H.Orderbook.decode(e,n):null}}function we(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=xe(),n=t.bidOrderbook,r=t.askOrderbook,a=ye(),c=a.market,o=n&&c?n.getL2(e).map((function(e){var t=Object(s.a)(e,2);return[t[0],t[1]]})):[],i=r&&c?r.getL2(e).map((function(e){var t=Object(s.a)(e,2);return[t[0],t[1]]})):[];return[{bids:o,asks:i},!!o||!!i]}function je(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=ye(),n=t.market,r=Z(),a=r.connected,c=r.wallet,o=R();function i(){return s.apply(this,arguments)}function s(){return(s=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",null);case 2:if(n){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,n.findOpenOrdersAccountsForOwner(o,c.publicKey);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return z(i,Object(B.a)("getOpenOrdersAccounts",c,n,a),{refreshInterval:e?1e3:5e3})}function Se(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=je(e),n=Object(s.a)(t,1),r=n[0];return r?r[0]:null}function Te(){var e=Z(),t=e.connected,n=e.wallet,r=R();function a(){return(a=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,se(r,n.publicKey);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return z((function(){return a.apply(this,arguments)}),Object(B.a)("getTokenAccounts",n,t),{refreshInterval:5e3})}function Ce(e,t){if(!e||!t)return null;var n=e.filter((function(e){var n=e.effectiveMint;return t.equals(n)}));return n&&n[0]}function Ae(){var e=Te(),t=Object(s.a)(e,1)[0],n=ye().market;return Ce(t,null===n||void 0===n?void 0:n.quoteMintAddress)}function Me(){var e=Te(),t=Object(s.a)(e,1)[0],n=ye().market;return Ce(t,null===n||void 0===n?void 0:n.baseMintAddress)}function Ie(){var e,t=Ae(),n=ye().market,r=W(null===t||void 0===t?void 0:t.pubkey),a=Object(s.a)(r,2),c=a[0],o=a[1];return n&&t&&o?n.quoteMintAddress.equals(H.TokenInstructions.WRAPPED_SOL_MINT)?null!==(e=(null===c||void 0===c?void 0:c.lamports)/1e9)&&void 0!==e?e:0:n.quoteSplSizeToNumber(new $.BN(c.data.slice(64,72),10,"le")):null}function ze(){var e,t=Me(),n=ye().market,r=W(null===t||void 0===t?void 0:t.pubkey),a=Object(s.a)(r,2),c=a[0],o=a[1];return n&&t&&o?n.baseMintAddress.equals(H.TokenInstructions.WRAPPED_SOL_MINT)?null!==(e=(null===c||void 0===c?void 0:c.lamports)/1e9)&&void 0!==e?e:0:n.baseSplSizeToNumber(new $.BN(c.data.slice(64,72),10,"le")):null}function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=Ee(e);return t?t.filter((function(e){return e.eventFlags.maker})).map((function(e){return Object(_.a)(Object(_.a)({},e),{},{side:"buy"===e.side?"sell":"buy"})})):null}function Be(){var e=ze(),t=Ie(),n=Se(!0),r=ye(),a=r.baseCurrency,c=r.quoteCurrency,o=r.market,i=n&&n.baseTokenTotal&&n.baseTokenFree,l=n&&n.quoteTokenTotal&&n.quoteTokenFree;return"UNKNOWN"!==a&&"UNKNOWN"!==c&&a&&c?[{market:o,key:"".concat(a).concat(c).concat(a),coin:a,wallet:e,orders:i&&o?o.baseSplSizeToNumber(n.baseTokenTotal.sub(n.baseTokenFree)):null,openOrders:n,unsettled:i&&o?o.baseSplSizeToNumber(n.baseTokenFree):null},{market:o,key:"".concat(c).concat(a).concat(c),coin:c,wallet:t,openOrders:n,orders:l&&o?o.quoteSplSizeToNumber(n.quoteTokenTotal.sub(n.quoteTokenFree)):null,unsettled:l&&o?o.quoteSplSizeToNumber(n.quoteTokenFree):null}]:[]}function Fe(e,t,n){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(u.a)(l.a.mark((function e(t,n,r){var a,c,o,i,u=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!(u.length>3&&void 0!==u[3])||u[3])){e.next=7;break}return e.next=4,t.findBaseTokenAccountsForOwner(n,r.publicKey);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,t.findQuoteTokenAccountsForOwner(n,r.publicKey);case 9:e.t0=e.sent;case 10:return c=e.t0,o=c&&c[0],e.next=14,n.getTokenAccountBalance(o.pubkey);case 14:return i=e.sent,e.abrupt("return",null===i||void 0===i||null===(a=i.value)||void 0===a?void 0:a.uiAmount);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(){var e=R(),t=pe().accounts,n=t&&Array.from(new Set(t.map((function(e){return e.market})))),r=n&&n.map((function(e){return e.toBase58()})),a=z(function(){var t=Object(u.a)(l.a.mark((function t(){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return",null);case 2:return r=function(){var t=Object(u.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=me.find((function(e){return e.address.equals(n)})),t.prev=1,console.log("Loading market",r.name),t.next=5,H.Market.load(e,r.address,{},r.programId);case 5:return t.abrupt("return",t.sent);case 8:return t.prev=8,t.t0=t.catch(1),console.log("Failed loading market",r.name,t.t0),Y({message:"Error loading market",description:t.t0.message,type:"error"}),t.abrupt("return",null);case 13:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),t.next=5,Promise.all(n.map(r));case 5:return t.abrupt("return",t.sent.filter((function(e){return e})));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Object(B.a)("useUnmigratedDeprecatedMarketsInner",e,r&&r.toString()),{refreshInterval:ve}),c=Object(s.a)(a,1)[0];return c?c.map((function(e){return{market:e,openOrdersList:t.filter((function(t){return t.market.equals(e.address)}))}})):null}function Ke(e){var t=e.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{address:new m.PublicKey(e.address),programId:new m.PublicKey(e.programId)})}));return[].concat(Object(E.a)(t),Object(E.a)(me))}var Re=n(41),Le=n(42);function De(){var e=Object(Re.a)(["\nhtml,body{\n  background: #11161D;\n}\ninput[type=number]::-webkit-inner-spin-button {\n  opacity: 0;\n}\ninput[type=number]:hover::-webkit-inner-spin-button,\ninput[type=number]:focus::-webkit-inner-spin-button {\n  opacity: 0.25;\n}\n/* width */\n::-webkit-scrollbar {\n  width: 15px;\n}\n/* Track */\n::-webkit-scrollbar-track {\n  background: #2d313c;\n}\n/* Handle */\n::-webkit-scrollbar-thumb {\n  background: #5b5f67;\n}\n/* Handle on hover */\n::-webkit-scrollbar-thumb:hover {\n  background: #5b5f67;\n}\n.ant-slider-track, .ant-slider:hover .ant-slider-track {\n  background-color: #2abdd2;\n  opacity: 0.75;\n}\n.ant-slider-track,\n.ant-slider ant-slider-track:hover {\n  background-color: #2abdd2;\n  opacity: 0.75;\n}\n.ant-slider-dot-active,\n.ant-slider-handle,\n.ant-slider-handle-click-focused,\n.ant-slider:hover .ant-slider-handle:not(.ant-tooltip-open)  {\n  border: 2px solid #2abdd2; \n}\n.ant-table-tbody > tr.ant-table-row:hover > td {\n  background: #273043;\n}\n.ant-table-tbody > tr > td {\n  border-bottom: 8px solid #1A2029;\n}\n.ant-table-container table > thead > tr:first-child th {\n  border-bottom: none;\n}\n.ant-divider-horizontal.ant-divider-with-text::before, .ant-divider-horizontal.ant-divider-with-text::after {\n  border-top: 1px solid #434a59 !important;\n}\n.ant-layout {\n    background: #11161D\n  }\n  .ant-table {\n    background: #212734;\n  }\n  .ant-table-thead > tr > th {\n    background: #1A2029;\n  }\n.ant-select-item-option-content {\n  img {\n    margin-right: 4px;\n  }\n}\n.ant-modal-content {\n  background-color: #212734;\n}\n\n@-webkit-keyframes highlight {\n  from { background-color: #2abdd2;}\n  to {background-color: #1A2029;}\n}\n@-moz-keyframes highlight {\n  from { background-color: #2abdd2;}\n  to {background-color: #1A2029;}\n}\n@-keyframes highlight {\n  from { background-color: #2abdd2;}\n  to {background-color: #1A2029;}\n}\n.flash {\n  -moz-animation: highlight 0.5s ease 0s 1 alternate ;\n  -webkit-animation: highlight 0.5s ease 0s 1 alternate;\n  animation: highlight 0.5s ease 0s 1 alternate;\n}"]);return De=function(){return e},e}var We=Object(Le.a)(De()),Ue=n(249),_e=n(168),He=n(165),Je=n(458),Qe=Je.a.Title,Ye=function(e){Object(_e.a)(n,e);var t=Object(He.a)(n);function n(){var e;Object(w.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={hasError:!1},e}return Object(x.a)(n,[{key:"render",value:function(){return this.state.hasError?a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(Qe,{level:2},"Something went wrong."),a.a.createElement(Qe,{level:4},"Please try again later."))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(r.Component),Ge=n(125),Xe=n(51),Ve=n(135),Ze=n(451),$e=n(452),et=n(463),tt=n(61);function nt(){var e=Object(Re.a)(["\n  margin: 5px;\n  padding: 20px;\n  background-color: #1a2029;\n"]);return nt=function(){return e},e}var rt=Le.c.div(nt());function at(e){var t=e.style,n=e.children;return a.a.createElement(rt,{style:Object(_.a)({},t)},n)}var ct=n(464),ot=n(465);function it(){var e=Object(Re.a)(["\n  position: absolute;\n  right: 5px;\n  color: white;\n"]);return it=function(){return e},e}function lt(){var e=Object(Re.a)(["\n      background-color: ",";\n    "]);return lt=function(){return e},e}function ut(){var e=Object(Re.a)(["\n      width: ",";\n    "]);return ut=function(){return e},e}function st(){var e=Object(Re.a)(["\n  text-align: right;\n  float: right;\n  height: 100%;\n  ","\n  ","\n"]);return st=function(){return e},e}function dt(){var e=Object(Re.a)(["\n  padding: 20px 0 14px;\n  font-weight: 700;\n"]);return dt=function(){return e},e}function mt(){var e=Object(Re.a)(["\n  padding: 20px 0 14px;\n  color: #434a59;\n"]);return mt=function(){return e},e}function ft(){var e=Object(Re.a)(["\n  color: rgba(255, 255, 255, 1);\n"]);return ft=function(){return e},e}var pt=Le.c.div(ft()),bt=Object(Le.c)(Ze.a)(mt()),vt=Object(Le.c)(Ze.a)(dt()),kt=Le.c.div(st(),(function(e){return e["data-width"]&&Object(Le.b)(ut(),e["data-width"])}),(function(e){return e["data-bgcolor"]&&Object(Le.b)(lt(),e["data-bgcolor"])})),ht=Le.c.div(it());function gt(e){var t=e.smallScreen,n=e.depth,c=void 0===n?7:n,o=e.onPrice,i=e.onSize,l=Oe(),u=we(),d=Object(s.a)(u,1)[0],m=ye(),f=m.baseCurrency,p=m.quoteCurrency,b=Object(r.useRef)(null),v=Object(r.useRef)(null),k=Object(r.useState)(null),h=Object(s.a)(k,2),g=h[0],y=h[1];function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.slice(0,c).reduce((function(e,n,r){var a,c=Object(s.a)(n,2),o=c[0],i=c[1],l=((null===(a=e[r-1])||void 0===a?void 0:a.cumulativeSize)||0)+i;return e.push({price:o,size:i,cumulativeSize:l,sizePercent:Math.round(l/(t||1)*100)}),e}),[]);return n&&(r=r.reverse()),r}return function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){clearInterval(e)}}}),[t])}((function(){if(!b.current||JSON.stringify(b.current)!==JSON.stringify(v.current)){var e=(null===d||void 0===d?void 0:d.bids)||[],t=(null===d||void 0===d?void 0:d.asks)||[],n=function(e,t,n){var r=Object(s.a)(t,2)[1];return n<c?e+r:e},r=e.reduce(n,0)+t.reduce(n,0),a=O(e,r,!1),o=O(t,r,!0);b.current={bids:null===d||void 0===d?void 0:d.bids,asks:null===d||void 0===d?void 0:d.asks},y({bids:a,asks:o})}}),250),Object(r.useEffect)((function(){v.current={bids:null===d||void 0===d?void 0:d.bids,asks:null===d||void 0===d?void 0:d.asks}}),[d]),a.a.createElement(at,{style:t?{flex:1}:{height:"500px",overflow:"hidden"}},a.a.createElement(pt,null,"Orderbook"),a.a.createElement(bt,null,a.a.createElement($e.a,{span:12,style:{textAlign:"left"}},"Size (",f,")"),a.a.createElement($e.a,{span:12,style:{textAlign:"right"}},"Price (",p,")")),null===g||void 0===g?void 0:g.asks.map((function(e){var t=e.price,n=e.size,r=e.sizePercent;return a.a.createElement(yt,{key:t+"",price:t,size:n,side:"sell",sizePercent:r,onPriceClick:function(){return o(t)},onSizeClick:function(){return i(n)}})})),a.a.createElement(Ot,{markPrice:l}),null===g||void 0===g?void 0:g.bids.map((function(e){var t=e.price,n=e.size,r=e.sizePercent;return a.a.createElement(yt,{key:t+"",price:t,size:n,side:"buy",sizePercent:r,onPriceClick:function(){return o(t)},onSizeClick:function(){return i(n)}})})))}var yt=a.a.memo((function(e){var t=e.side,n=e.price,c=e.size,o=e.sizePercent,i=e.onSizeClick,l=e.onPriceClick,u=Object(r.useRef)(),s=ye().market;Object(r.useEffect)((function(){var e,t;!(null===(e=u.current)||void 0===e?void 0:e.classList.contains("flash"))&&(null===(t=u.current)||void 0===t||t.classList.add("flash"));var n=setTimeout((function(){var e,t;return(null===(e=u.current)||void 0===e?void 0:e.classList.contains("flash"))&&(null===(t=u.current)||void 0===t?void 0:t.classList.remove("flash"))}),250);return function(){return clearTimeout(n)}}),[n,c]);var d=(null===s||void 0===s?void 0:s.minOrderSize)&&!isNaN(c)?Number(c).toFixed(g(s.minOrderSize)+1):c,m=(null===s||void 0===s?void 0:s.tickSize)&&!isNaN(n)?Number(n).toFixed(g(s.tickSize)+1):n;return a.a.createElement(Ze.a,{ref:u,style:{marginBottom:1},onClick:i},a.a.createElement($e.a,{span:12,style:{textAlign:"left"}},d),a.a.createElement($e.a,{span:12,style:{textAlign:"right"}},a.a.createElement(kt,{"data-width":o+"%","data-bgcolor":"buy"===t?"rgba(65, 199, 122, 0.6)":"rgba(242, 60, 105, 0.6)"}),a.a.createElement(ht,{onClick:l},m)))}),(function(e,t){return O(e,t,["price","size","sizePercent"])})),Ot=a.a.memo((function(e){var t=e.markPrice,n=ye().market,c=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e}),[e]),t.current}(t),o=t>c?"#41C77A":t<c?"#F23B69":"white",i=t&&(null===n||void 0===n?void 0:n.tickSize)&&t.toFixed(g(n.tickSize));return a.a.createElement(vt,{justify:"center"},a.a.createElement($e.a,{style:{color:o}},t>c&&a.a.createElement(ct.a,{style:{marginRight:5}}),t<c&&a.a.createElement(ot.a,{style:{marginRight:5}}),i||"----"))}),(function(e,t){return O(e,t,["markPrice"])})),Et=n(28),xt=n(455);function wt(e){var t=e.dataSource,n=e.columns,r=e.emptyLabel,c=void 0===r?"No data":r,o=e.pagination,i=void 0!==o&&o,l=e.loading,u=void 0!==l&&l,s=e.pageSize,d=void 0===s?10:s;return a.a.createElement(Et.b,{renderEmpty:function(){return a.a.createElement("div",{style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center"}},c)}},a.a.createElement(xt.a,{dataSource:t,columns:n,pagination:!!i&&{pagination:!0,pageSize:d},loading:u}))}function jt(e){return St.apply(this,arguments)}function St(){return(St=Object(u.a)(l.a.mark((function e(t){var n,r,a,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connection,r=t.wallet,a=t.mintPublicKey,c=new m.Account,e.t0=m.SystemProgram,e.t1=r.publicKey,e.t2=c.publicKey,e.next=7,n.getMinimumBalanceForRentExemption(165);case 7:return e.t3=e.sent,e.t4=H.TokenInstructions.TOKEN_PROGRAM_ID,e.t5={fromPubkey:e.t1,newAccountPubkey:e.t2,lamports:e.t3,space:165,programId:e.t4},(o=e.t0.createAccount.call(e.t0,e.t5)).add(H.TokenInstructions.initializeAccount({account:c.publicKey,mint:a,owner:r.publicKey})),e.abrupt("return",{transaction:o,signer:c,newAccountPubkey:c.publicKey});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(e){return Ct.apply(this,arguments)}function Ct(){return(Ct=Object(u.a)(l.a.mark((function e(t){var n,r,a,c,o,i,u,s,d,m,f,p,b,v,k,h,g,y,O,x,w;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.market,r=t.openOrders,a=t.connection,c=t.wallet,o=t.baseCurrencyAccount,i=t.quoteCurrencyAccount,u=t.onSuccess,n&&c&&a&&r&&(o||i)){e.next=4;break}return Y({message:"Not connected"}),e.abrupt("return");case 4:if(m=null===o||void 0===o?void 0:o.pubkey,f=null===i||void 0===i?void 0:i.pubkey,m){e.next=13;break}return e.next=9,jt({connection:a,wallet:c,mintPublicKey:n.baseMintAddress});case 9:p=e.sent,m=null===p||void 0===p?void 0:p.newAccountPubkey,s=null===p||void 0===p?void 0:p.transaction,d=null===p||void 0===p?void 0:p.signer;case 13:if(f){e.next=20;break}return e.next=16,jt({connection:a,wallet:c,mintPublicKey:n.quoteMintAddress});case 16:b=e.sent,f=null===b||void 0===b?void 0:b.newAccountPubkey,s=null===b||void 0===b?void 0:b.transaction,d=null===b||void 0===b?void 0:b.signer;case 20:return null,n.supportsReferralFees,e.next=24,n.makeSettleFundsTransaction(a,r,m,f,null);case 24:return v=e.sent,k=v.transaction,h=v.signers,g=Lt([s,k]),y=d?[].concat(Object(E.a)(h),[d]):h,O=function(e){e.timeout?Y({message:"Timed out",type:"error",description:"Timed out awaiting confirmation on transaction"}):e.err?(console.log(e.err),Y({message:"Error settling funds",type:"error"})):(Y({message:"Fund settlement confirmed",type:"success"}),u&&u())},x=function(){return Y({message:"Settling funds..."})},w=function(){return Y({message:"Funds settled",type:"success"})},e.next=34,Pt({transaction:g,signers:y,wallet:c,connection:a,onBeforeSend:x,onAfterSend:w,onConfirm:O});case 34:return e.abrupt("return",e.sent);case 35:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function At(e){return Mt.apply(this,arguments)}function Mt(){return(Mt=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",It(Object(_.a)(Object(_.a)({},t),{},{orders:[t.order]})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function It(e){return zt.apply(this,arguments)}function zt(){return(zt=Object(u.a)(l.a.mark((function e(t){var n,r,a,c,o,i,u,s,d,m,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.market,r=t.wallet,a=t.connection,c=t.orders,o=t.onBeforeSendCallBack,i=t.onAfterSendCallBack,u=t.onConfirmCallBack,s=n.makeMatchOrdersTransaction(5),c.forEach((function(e){s.add(n.makeCancelOrderInstruction(a,r.publicKey,e))})),s.add(n.makeMatchOrdersTransaction(5)),d=function(e){e.timeout?Y({message:"Timed out",type:"error",description:"Timed out awaiting confirmation on transaction"}):e.err?(console.log(e.err),Y({message:c.length>1?"Error cancelling orders":"Error cancelling order",type:"error"})):Y({message:c.length>1?"Order cancellations confirmed":"Order cancellation confirmed",type:"success"}),u&&u()},m=function(){Y({message:"Sending cancel..."}),o&&o()},f=function(){Y({message:c.length>1?"Orders cancelled":"Order cancelled",type:"success"}),i&&i()},e.next=9,Pt({transaction:s,wallet:r,connection:a,onBeforeSend:m,onAfterSend:f,onConfirm:d});case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nt(e){return Bt.apply(this,arguments)}function Bt(){return(Bt=Object(u.a)(l.a.mark((function e(t){var n,r,a,c,o,i,u,s,d,m,f,p,b,v,k,h,y,O,E,x,w,j,S,T,C,A,M;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.side,c=t.price,o=t.size,i=t.orderType,u=t.market,s=t.connection,d=t.wallet,m=t.baseCurrencyAccount,f=t.quoteCurrencyAccount,p=t.onBeforeSendCallBack,b=t.onAfterSendCallBack,v=t.onConfirmCallBack,k=(null===u||void 0===u||null===(n=u.minOrderSize)||void 0===n?void 0:n.toFixed(g(u.minOrderSize)))||(null===u||void 0===u?void 0:u.minOrderSize),h=(null===u||void 0===u||null===(r=u.tickSize)||void 0===r?void 0:r.toFixed(g(u.tickSize)))||(null===u||void 0===u?void 0:u.tickSize),y=function(e,t){return Math.abs(e/t%1)<1e-5||Math.abs(e/t%1-1)<1e-5},!isNaN(c)){e.next=7;break}return Y({message:"Invalid price",type:"error"}),e.abrupt("return");case 7:if(!isNaN(o)){e.next=10;break}return Y({message:"Invalid size",type:"error"}),e.abrupt("return");case 10:if(d&&d.publicKey){e.next=13;break}return Y({message:"Connect wallet",type:"error"}),e.abrupt("return");case 13:if(u){e.next=16;break}return Y({message:"Invalid  market",type:"error"}),e.abrupt("return");case 16:if(y(o,u.minOrderSize)){e.next=19;break}return Y({message:"Size must be an increment of ".concat(k),type:"error"}),e.abrupt("return");case 19:if(!(o<u.minOrderSize)){e.next=22;break}return Y({message:"Size too small",type:"error"}),e.abrupt("return");case 22:if(y(c,u.tickSize)){e.next=25;break}return Y({message:"Price must be an increment of ".concat(h),type:"error"}),e.abrupt("return");case 25:if(!(c<u.tickSize)){e.next=28;break}return Y({message:"Price under tick size",type:"error"}),e.abrupt("return");case 28:if(O=d.publicKey,E="sell"===a?m:f){e.next=33;break}return Y({message:"Need an SPL token account for cost currency",type:"error"}),e.abrupt("return");case 33:return x={owner:O,payer:E,side:a,price:c,size:o,orderType:i},console.log(x),w=u.makeMatchOrdersTransaction(5),e.next=38,u.makePlaceOrderTransaction(s,x,1e4,1e4);case 38:return j=e.sent,S=j.transaction,T=j.signers,w.add(S),w.add(u.makeMatchOrdersTransaction(5)),C=function(e){e.timeout?Y({message:"Timed out",type:"error",description:"Timed out awaiting confirmation on transaction"}):e.err?(console.log(e.err),Y({message:"Error placing order",type:"error"})):Y({message:"Order confirmed",type:"success"}),v&&v()},A=function(){Y({message:"Sending order..."}),p&&p()},M=function(){Y({message:"Order sent",type:"success"}),b&&b()},e.next=48,Pt({transaction:w,wallet:d,connection:s,onBeforeSend:A,onAfterSend:M,onConfirm:C,signers:T});case 48:return e.abrupt("return",e.sent);case 49:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ft=function(){return(new Date).getTime()/1e3};function Pt(e){return qt.apply(this,arguments)}function qt(){return(qt=Object(u.a)(l.a.mark((function e(t){var n,r,a,c,o,i,u,s,d,m,f,b,v,k;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.transaction,r=t.wallet,a=t.signers,c=void 0===a?[r.publicKey]:a,o=t.connection,i=t.onBeforeSend,u=t.onAfterSend,s=t.onConfirm,d=t.timeout,m=void 0===d?15e3:d,e.next=3,o.getRecentBlockhash("max");case 3:return n.recentBlockhash=e.sent.blockhash,n.signPartial.apply(n,Object(E.a)(c)),e.next=7,r.signTransaction(n);case 7:return f=e.sent.serialize(),b=!1,v=Ft(),i(),e.next=13,o.sendRawTransaction(f,{skipPreflight:!0});case 13:k=e.sent,u(),console.log("Started sending transaction for",k),Kt(k,m,o).then((function(e){b=!0,s(e)})).catch((function(e){b=!0,s(e)}));case 17:if(b||!(Ft()-v<m)){e.next=23;break}return o.sendRawTransaction(f,{skipPreflight:!0}),e.next=21,p(300);case 21:e.next=17;break;case 23:return console.log("Latency",k,Ft()-v),e.abrupt("return",k);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kt(e,t,n){return Rt.apply(this,arguments)}function Rt(){return(Rt=Object(u.a)(l.a.mark((function e(t,n,r){var a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!1,e.next=3,new Promise((function(e,c){Object(u.a)(l.a.mark((function o(){return l.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:setTimeout((function(){a||(a=!0,console.log("Timed out for txid",t),c({timeout:!0}))}),n);try{r.onSignature(t,(function(n){console.log("WS confirmed",t,n),a=!0,n.err?c(n):e(n)}),"recent"),console.log("Set up WS connection",t)}catch(i){a=!0,console.log("WS error in setup",t,i)}case 2:if(a){o.next=8;break}return Object(u.a)(l.a.mark((function n(){var o,i;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.getSignatureStatuses([t]);case 3:o=n.sent,i=o&&o.value[0],a||(i?i.err?(console.log("REST error for",t,i),a=!0,c(i)):i.confirmations?(console.log("REST confirmation for",t,i),a=!0,e(i)):console.log("REST no confirmations for",t,i):console.log("REST null result for",t,i)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),a||console.log("REST connection error: txid",t,n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))(),o.next=6,p(300);case 6:o.next=2;break;case 8:case"end":return o.stop()}}),o)})))()}));case 3:return c=e.sent,a=!0,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lt(e){var t=new m.Transaction;return e.filter((function(e){return e})).forEach((function(e){t.add(e)})),t}function Dt(e){var t=e.balances,n=e.showMarket,r=e.hideWalletBalance,c=e.onSettleSuccess,o=Te(),i=Object(s.a)(o,1)[0],d=L(),m=Z().wallet;function f(){return(f=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt({market:t,openOrders:n,connection:d,wallet:m,baseCurrencyAccount:Ce(i,null===t||void 0===t?void 0:t.baseMintAddress),quoteCurrencyAccount:Ce(i,null===t||void 0===t?void 0:t.quoteMintAddress),onSuccess:c});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p=[n?{title:"Market",dataIndex:"marketName",key:"marketName"}:null,{title:"Coin",dataIndex:"coin",key:"coin"},r?null:{title:"Wallet Balance",dataIndex:"wallet",key:"wallet"},{title:"Orders",dataIndex:"orders",key:"orders"},{title:"Unsettled",dataIndex:"unsettled",key:"unsettled"},{key:"action",render:function(e){var t=e.market,n=e.openOrders,r=e.marketName;return a.a.createElement("div",{style:{textAlign:"right"}},a.a.createElement(tt.a,{ghost:!0,style:{marginRight:12},onClick:function(){return function(e,t){return f.apply(this,arguments)}(t,n)}},"Settle ",r))}}].filter((function(e){return e}));return a.a.createElement(wt,{emptyLabel:"No balances",dataSource:t,columns:p,pagination:!1})}var Wt=n(461),Ut=n(466);function _t(){var e=Object(Re.a)(["\n  color: #f23b69;\n  border: 1px solid #f23b69;\n"]);return _t=function(){return e},e}var Ht=Object(Le.c)(tt.a)(_t());function Jt(e){var t=e.openOrders,n=e.onCancelSuccess,c=Z().wallet,o=L(),i=Object(r.useState)(null),d=Object(s.a)(i,2),m=d[0],f=d[1];function p(){return(p=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,At({order:t,market:t.market,connection:o,wallet:c,onBeforeSendCallBack:function(){return f(null===t||void 0===t?void 0:t.orderId)},onConfirmCallBack:function(){f(null),n&&n()}});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),Y({message:"Error cancelling order: "+e.t0.message,type:"error"}),f(null);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}var b=[{title:"Market",dataIndex:"marketName",key:"marketName"},{title:"Side",dataIndex:"side",key:"side",render:function(e){return a.a.createElement(Wt.a,{color:"buy"===e?"#41C77A":"#F23B69",style:{fontWeight:700}},e.charAt(0).toUpperCase()+e.slice(1))}},{title:"Size",dataIndex:"size",key:"size"},{title:"Price",dataIndex:"price",key:"price"},{key:"orderId",render:function(e){return a.a.createElement("div",{style:{textAlign:"right"}},a.a.createElement(Ht,{icon:a.a.createElement(Ut.a,null),onClick:function(){return function(e){return p.apply(this,arguments)}(e)},loading:m+""===(null===e||void 0===e?void 0:e.orderId)+""},"Cancel"))}}],v=(t||[]).map((function(e){return Object.assign(e,{key:e.orderId})}));return a.a.createElement(Ze.a,null,a.a.createElement($e.a,{span:24},a.a.createElement(wt,{emptyLabel:"No open orders",dataSource:v,columns:b,pagination:!0,pageSize:5})))}var Qt=n(456);function Yt(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=ye(),n=t.marketName,r=Ee(e),a=je(),c=Object(s.a)(a,1),o=c[0];return o&&0!==o.length&&r?r.filter((function(e){return o.some((function(t){return e.openOrders.equals(t.publicKey)}))})).map((function(e){return Object(_.a)(Object(_.a)({},e),{},{marketName:n})})):null}(),t=ye().quoteCurrency,n=[{title:"Market",dataIndex:"marketName",key:"marketName"},{title:"Side",dataIndex:"side",key:"side",render:function(e){return a.a.createElement(Wt.a,{color:"buy"===e?"#41C77A":"#F23B69",style:{fontWeight:700}},e.charAt(0).toUpperCase()+e.slice(1))}},{title:"Size",dataIndex:"size",key:"size"},{title:"Price",dataIndex:"price",key:"price"},{title:"Liquidity",dataIndex:"liquidity",key:"liquidity"},{title:t?"Fees (".concat(t,")"):"Fees",dataIndex:"feeCost",key:"feeCost"}],r=(e||[]).map((function(e){return Object(_.a)(Object(_.a)({},e),{},{key:"".concat(e.orderId).concat(e.side),liquidity:e.eventFlags.maker?"Maker":"Taker"})}));return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ze.a,null,a.a.createElement($e.a,{span:24},a.a.createElement(wt,{dataSource:r,columns:n,pagination:!0,pageSize:5,emptyLabel:"No fills"}))))}function Gt(){var e=function(){var e=ye().market,t=Z(),n=t.connected,r=t.wallet,a=R();function c(){return(c=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return",null);case 2:if(e){t.next=4;break}return t.abrupt("return",null);case 4:return t.next=6,e.findFeeDiscountKeys(a,r.publicKey);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return z((function(){return c.apply(this,arguments)}),Object(B.a)("getFeeDiscountKeys",r,e,n),{refreshInterval:5e3})}(),t=[{title:"Fee Tier",dataIndex:"feeTier",key:"feeTier",render:function(e,t){return a.a.createElement("div",{style:{display:"flex"}},a.a.createElement(Je.a,null,e),0===t.index?a.a.createElement("div",{style:{marginLeft:10}},a.a.createElement(Wt.a,{color:"#41C77A",style:{fontWeight:700}},"Selected")):null)}},{title:"Taker",dataIndex:"taker",key:"taker",render:function(e,t){return v.format(Object(H.getFeeRates)(t.feeTier).taker)}},{title:"Maker",dataIndex:"maker",key:"maker",render:function(e,t){return v.format(Object(H.getFeeRates)(t.feeTier).maker)}},{title:"Public Key",dataIndex:"pubkey",key:"pubkey",render:function(e){return e.toBase58()}},{title:"Balance",dataIndex:"balance",key:"balance"},{title:"Mint",dataIndex:"mint",key:"mint",render:function(e,t){return t.mint.equals(H.TokenInstructions.SRM_MINT)?"SRM":t.mint.equals(H.TokenInstructions.MSRM_MINT)?"MSRM":"UNKNOWN"}}],n=(Object(s.a)(e,1)[0]||[]).map((function(e,t){return Object(_.a)(Object(_.a)({},e),{},{index:t,key:e.pubkey.toBase58()})}));return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ze.a,null,a.a.createElement($e.a,{span:24},a.a.createElement(wt,{dataSource:n,columns:t,pagination:!0,pageSize:5,emptyLabel:"No (M)SRM accounts"}))),a.a.createElement(Ze.a,{style:{marginTop:8}},a.a.createElement($e.a,null,a.a.createElement(Je.a,null,"Holding SRM or MSRM makes you eligible for fee discounts:"),a.a.createElement(Xt,null))))}function Xt(){var e=[{title:"Fee Tier",dataIndex:"feeTier",key:"feeTier"},{title:"Taker",dataIndex:"taker",key:"taker",render:function(e,t){return v.format(Object(H.getFeeRates)(t.feeTier).taker)}},{title:"Maker",dataIndex:"maker",key:"maker",render:function(e,t){return v.format(Object(H.getFeeRates)(t.feeTier).maker)}},{title:"Requirements",dataIndex:"requirements",key:"requirements",render:function(e,t){return a.a.createElement(Je.a,null,t.balance?"\u2265 ".concat(t.balance," ").concat(t.token):"None")}}];return a.a.createElement(wt,{dataSource:[{feeTier:0,taker:.0022,maker:-3e-4,token:"",balance:""},{feeTier:1,taker:.002,maker:-3e-4,token:"SRM",balance:100},{feeTier:2,taker:.0018,maker:-3e-4,token:"SRM",balance:1e3},{feeTier:3,taker:.0016,maker:-3e-4,token:"SRM",balance:1e4},{feeTier:4,taker:.0014,maker:-3e-4,token:"SRM",balance:1e5},{feeTier:5,taker:.0012,maker:-3e-4,token:"SRM",balance:1e6},{feeTier:6,taker:.001,maker:-5e-4,token:"MSRM",balance:1}].map((function(e){return Object(_.a)(Object(_.a)({},e),{},{key:e.feeTier})})),columns:e})}var Vt=Je.a.Paragraph,Zt=Qt.a.TabPane;function $t(){var e=ye().market;return a.a.createElement(at,{style:{flex:1,paddingTop:20}},a.a.createElement(Je.a,null,a.a.createElement(Vt,{style:{color:"rgba(255,255,255,0.5)"}},"Make sure to go to Balances and click Settle to send out your funds."),a.a.createElement(Vt,{style:{color:"rgba(255,255,255,0.5)"}},"To fund your wallet, ",a.a.createElement("a",{href:"https://www.sollet.io"},"sollet.io"),". You can get SOL from FTX, Binance, BitMax, and others. You can get other tokens from FTX."," ")),a.a.createElement(Qt.a,{defaultActiveKey:"orders"},a.a.createElement(Zt,{tab:"Open Orders",key:"orders"},a.a.createElement(en,null)),a.a.createElement(Zt,{tab:"Recent Trade History",key:"fills"},a.a.createElement(Yt,null)),a.a.createElement(Zt,{tab:"Balances",key:"balances"},a.a.createElement(tn,null)),e&&e.supportsSrmFeeDiscounts?a.a.createElement(Zt,{tab:"Fee discounts",key:"fees"},a.a.createElement(Gt,null)):null))}var en=function(){var e=function(){var e=ye(),t=e.market,n=e.marketName,r=Se(),a=xe(),c=a.bidOrderbook,o=a.askOrderbook;return t&&r&&c&&o?t.filterForOpenOrders(c,o,[r]).map((function(e){return Object(_.a)(Object(_.a)({},e),{},{marketName:n,market:t})})):null}();return a.a.createElement(Jt,{openOrders:e})},tn=function(){var e=Be();return a.a.createElement(Dt,{balances:e})},nn=n(453),rn=n(459),an=n(193);function cn(e){var t=e.external,n=void 0!==t&&t,r=Object(an.a)(e,["external"]),c=r.to,o=r.children,i=Object(an.a)(r,["to","children"]);return n?a.a.createElement("a",Object.assign({href:c,target:"_blank",rel:"noopener noreferrer"},i),o):a.a.createElement(Ge.b,Object.assign({to:c},i),o)}function on(e){var t,n,r,c=e.onClose,o=e.baseOrQuote,i=ye(),l=i.market,u=i.baseCurrency,s=i.quoteCurrency,d=Z(),m=d.providerName,f=d.providerUrl,p=Me(),b=Ae();return"base"===o?(t=null===l||void 0===l?void 0:l.baseMintAddress,n=p,r=u):"quote"===o?(t=null===l||void 0===l?void 0:l.quoteMintAddress,n=b,r=s):n=null,t?a.a.createElement(rn.a,{title:r,visible:!!t,onOk:c,onCancel:c},a.a.createElement("div",{style:{paddingTop:"20px"}},a.a.createElement("p",{style:{color:"white"}},"Mint address:"),a.a.createElement("p",{style:{color:"rgba(255,255,255,0.5)"}},t.toBase58()),a.a.createElement("div",null,a.a.createElement("p",{style:{color:"white"}},"Deposit address:"),a.a.createElement("p",{style:{color:"rgba(255,255,255,0.5)"}},n?n.pubkey.toBase58():a.a.createElement(a.a.Fragment,null,"Visit"," ",a.a.createElement(cn,{external:!0,to:f},m)," ","to create an account for this mint"))))):null}function ln(){var e=Object(Re.a)(["\n  color: #2abdd2;\n  background-color: #212734;\n  border-width: 0px;\n"]);return ln=function(){return e},e}function un(){var e=Object(Re.a)(["\n  font-size: 12px;\n  padding-top: 6px;\n"]);return un=function(){return e},e}function sn(){var e=Object(Re.a)(["\n  padding-bottom: 20px;\n"]);return sn=function(){return e},e}var dn=Object(Le.c)(Ze.a)(sn()),mn=Le.c.p(un()),fn=Object(Le.c)(tt.a)(ln());function pn(){var e=ye(),t=e.baseCurrency,n=e.quoteCurrency,c=e.market,o=Be(),i=Se(!0),d=L(),m=Z(),f=m.providerUrl,p=m.providerName,b=m.wallet,v=Object(r.useState)(""),k=Object(s.a)(v,2),h=k[0],g=k[1],y=Me(),O=Ae(),E=o&&o.find((function(e){return e.coin===t})),x=o&&o.find((function(e){return e.coin===n}));function w(){return j.apply(this,arguments)}function j(){return(j=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt({market:c,openOrders:i,connection:d,wallet:b,baseCurrencyAccount:y,quoteCurrencyAccount:O});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return a.a.createElement(at,{style:{flex:1,paddingTop:10}},[[t,E,"base"],[n,x,"quote"]].map((function(e,t){var n=Object(s.a)(e,3),r=n[0],c=n[1],o=n[2];return a.a.createElement(a.a.Fragment,{key:t},a.a.createElement(nn.a,{style:{borderColor:"white"}},r),a.a.createElement(dn,{align:"middle",justify:"space-between",style:{paddingBottom:12}},a.a.createElement($e.a,null,"Wallet balance:"),a.a.createElement($e.a,null,c&&c.wallet)),a.a.createElement(dn,{align:"middle",justify:"space-between",style:{paddingBottom:12}},a.a.createElement($e.a,null,"Unsettled balance:"),a.a.createElement($e.a,null,c&&c.unsettled)),a.a.createElement(dn,{align:"middle",justify:"space-around"},a.a.createElement($e.a,{style:{width:150}},a.a.createElement(fn,{block:!0,size:"large",onClick:function(){return g(o)}},"Deposit")),a.a.createElement($e.a,{style:{width:150}},a.a.createElement(fn,{block:!0,size:"large",onClick:w},"Settle"))),a.a.createElement(mn,null,"All deposits go to your"," ",a.a.createElement(cn,{external:!0,to:f},p)," ","wallet"))})),a.a.createElement(on,{baseOrQuote:h,onClose:function(){return g("")}}))}var bn=n(166),vn=n(460),kn=n(457),hn=n(462);function gn(){var e=Object(Re.a)(["\n  margin: 20px 0px 0px 0px;\n  background: #02bf76;\n  border-color: #02bf76;\n"]);return gn=function(){return e},e}function yn(){var e=Object(Re.a)(["\n  margin: 20px 0px 0px 0px;\n  background: #f23b69;\n  border-color: #f23b69;\n"]);return yn=function(){return e},e}var On=Object(Le.c)(tt.a)(yn()),En=Object(Le.c)(tt.a)(gn()),xn={0:"0%",25:"25%",50:"50%",75:"75%",100:"100%"};function wn(e){var t=e.style,n=e.setChangeOrderRef,c=Object(r.useState)("buy"),o=Object(s.a)(c,2),i=o[0],d=o[1],m=ye(),f=m.baseCurrency,p=m.quoteCurrency,b=m.market,v=ze(),y=Ie(),O=Me(),E=Ae(),x=Se(!0),w=Z().wallet,j=L(),S=Oe(),T=Object(r.useState)(!1),C=Object(s.a)(T,2),A=C[0],M=C[1],I=Object(r.useState)(!1),z=Object(s.a)(I,2),N=z[0],B=z[1],F=Object(r.useState)(null),P=Object(s.a)(F,2),q=P[0],K=P[1],R=Object(r.useState)(null),D=Object(s.a)(R,2),W=D[0],U=D[1],H=Object(r.useState)(null),J=Object(s.a)(H,2),Q=J[0],G=J[1],X=Object(r.useState)(!1),V=Object(s.a)(X,2),$=V[0],ee=V[1],te=Object(r.useState)(0),ne=Object(s.a)(te,2),re=ne[0],ae=ne[1],ce=(y||0)+((x?b.quoteSplSizeToNumber(x.quoteTokenFree):0)||0),oe=v||0,ie=(null===b||void 0===b?void 0:b.minOrderSize)&&g(b.minOrderSize),le=(null===b||void 0===b?void 0:b.tickSize)&&g(b.tickSize);Object(r.useEffect)((function(){n&&n(se)}),[n]),Object(r.useEffect)((function(){q&&Q&&me(re)}),[i]),Object(r.useEffect)((function(){de()}),[Q,q]);var ue=function(e){K(e);var t=e&&h(e*(Q||S),ie);U(t)},se=function(e){var t=e.size,n=e.price,r=t&&h(t,ie),a=n&&h(n,le);r&&ue(r),a&&G(a)},de=function(){var e=k("buy"===i?ce/Q:oe,ie),t=Math.min(q/e*100,100);ae(t)},me=function(e){if(!Q&&S){var t=le?S.toFixed(le):S;G(t)}var n;"buy"===i?(Q||S)&&(n=ce/(Q||S)*e/100):n=oe*e/100;var r=k(n,ie);ue(r)};function fe(){return pe.apply(this,arguments)}function pe(){return(pe=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseFloat(Q),n=parseFloat(q),ee(!0),e.prev=3,e.next=6,Nt({side:i,price:t,size:n,orderType:N?"ioc":A?"postOnly":"limit",market:b,connection:j,wallet:w,baseCurrencyAccount:null===O||void 0===O?void 0:O.pubkey,quoteCurrencyAccount:null===E||void 0===E?void 0:E.pubkey,onConfirmCallBack:function(){G(null),ue(null)}});case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),console.warn(e.t0),Y({message:"Error placing order: "+e.t0.message,type:"error"});case 12:return e.prev=12,ee(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[3,8,12,15]])})))).apply(this,arguments)}return a.a.createElement(at,{style:Object(_.a)({display:"flex",flexDirection:"column"},t)},a.a.createElement("div",{style:{flex:1}},a.a.createElement(bn.a.Group,{onChange:function(e){return d(e.target.value)},value:i,buttonStyle:"solid",style:{marginBottom:8,width:"100%"}},a.a.createElement(bn.a.Button,{value:"buy",style:{width:"50%",textAlign:"center",background:"buy"===i?"#02bf76":"",borderColor:"buy"===i?"#02bf76":""}},"BUY"),a.a.createElement(bn.a.Button,{value:"sell",style:{width:"50%",textAlign:"center",background:"sell"===i?"#F23B69":"",borderColor:"sell"===i?"#F23B69":""}},"SELL")),a.a.createElement(vn.a,{style:{textAlign:"right",paddingBottom:8},addonBefore:a.a.createElement("div",{style:{width:"30px"}},"Price"),suffix:a.a.createElement("span",{style:{fontSize:10,opacity:.5}},p),value:Q,type:"number",step:(null===b||void 0===b?void 0:b.tickSize)||1,onChange:function(e){return G(e.target.value)}}),a.a.createElement(vn.a.Group,{compact:!0,style:{paddingBottom:8}},a.a.createElement(vn.a,{style:{width:"calc(50% + 30px)",textAlign:"right"},addonBefore:a.a.createElement("div",{style:{width:"30px"}},"Size"),suffix:a.a.createElement("span",{style:{fontSize:10,opacity:.5}},f),value:q,type:"number",step:(null===b||void 0===b?void 0:b.minOrderSize)||1,onChange:function(e){return ue(e.target.value)}}),a.a.createElement(vn.a,{style:{width:"calc(50% - 30px)",textAlign:"right"},suffix:a.a.createElement("span",{style:{fontSize:10,opacity:.5}},p),value:W,type:"number",step:(null===b||void 0===b?void 0:b.minOrderSize)||1,onChange:function(e){return function(e){U(e);var t=e&&h(e/Q,ie);K(t)}(e.target.value)}})),a.a.createElement(kn.a,{value:re,tipFormatter:function(e){return"".concat(e,"%")},marks:xn,onChange:me}),a.a.createElement("div",{style:{paddingTop:18}},"POST ",a.a.createElement(hn.a,{checked:A,onChange:function(e){e&&B(!1),M(e)},style:{marginRight:40}}),"IOC ",a.a.createElement(hn.a,{checked:N,onChange:function(e){e&&M(!1),B(e)}}))),"buy"===i?a.a.createElement(En,{disabled:!Q||!q,onClick:fe,block:!0,type:"primary",size:"large",loading:$},"Buy ",f):a.a.createElement(On,{disabled:!Q||!q,onClick:fe,block:!0,type:"primary",size:"large",loading:$},"Sell ",f))}function jn(){var e=Object(Re.a)(["\n  height: calc(100% - 75px);\n  margin-right: -20px;\n  padding-right: 5px;\n  overflow-y: scroll;\n"]);return jn=function(){return e},e}function Sn(){var e=Object(Re.a)(["\n  padding: 20px 0 14px;\n  color: #434a59;\n"]);return Sn=function(){return e},e}function Tn(){var e=Object(Re.a)(["\n  color: rgba(255, 255, 255, 1);\n"]);return Tn=function(){return e},e}var Cn=Le.c.div(Tn()),An=Object(Le.c)(Ze.a)(Sn()),Mn=Le.c.div(jn());function In(e){var t=e.smallScreen,n=ye(),r=n.baseCurrency,c=n.quoteCurrency,o=n.market,i=Ne();return a.a.createElement(at,{style:t?{flex:1}:{marginTop:"10px",minHeight:"270px",height:"calc(100vh - 710px)"}},a.a.createElement(Cn,null,"Recent Market trades"),a.a.createElement(An,null,a.a.createElement($e.a,{span:12,style:{textAlign:"left"}},"Size (",r,")"),a.a.createElement($e.a,{span:12,style:{textAlign:"right"}},"Price (",c,")"," ")),!!i&&a.a.createElement(Mn,null,i.map((function(e,t){return a.a.createElement(Ze.a,{key:t,style:{marginBottom:4}},a.a.createElement($e.a,{span:12,style:{textAlign:"left"}},(null===o||void 0===o?void 0:o.minOrderSize)&&!isNaN(e.size)?Number(e.size).toFixed(g(o.minOrderSize)):e.size),a.a.createElement($e.a,{span:12,style:{textAlign:"right",color:"buy"===e.side?"#41C77A":"#F23B69"}},(null===o||void 0===o?void 0:o.tickSize)&&!isNaN(e.price)?Number(e.price).toFixed(g(o.tickSize)):e.price))}))))}var zn=n(467);function Nn(e){var t=e.title,n=e.address;return a.a.createElement("div",null,t&&a.a.createElement("p",{style:{color:"white"}},t),a.a.createElement(tt.a,{type:"link",icon:a.a.createElement(zn.a,null),href:"https://explorer.solana.com/address/"+n,target:"_blank"},n))}var Bn=n(159),Fn=n.n(Bn),Pn=n(254),qn=n.n(Pn),Kn=Je.a.Title;function Rn(e){var t=e.switchToLiveMarkets,n=function(){var e=qe(),t=y("customMarkets",[]),n=Object(s.a)(t,1)[0];if(!e)return null;var r=[];return e.forEach((function(e){var t=e.market,a=e.openOrdersList,c=he(t,n),o=c.baseCurrency,i=c.quoteCurrency,l=c.marketName;a.forEach((function(e){var n=(null===e||void 0===e?void 0:e.baseTokenTotal)&&(null===e||void 0===e?void 0:e.baseTokenFree)&&t.baseSplSizeToNumber(e.baseTokenTotal.sub(e.baseTokenFree)),a=(null===e||void 0===e?void 0:e.quoteTokenTotal)&&(null===e||void 0===e?void 0:e.quoteTokenFree)&&t.baseSplSizeToNumber(e.quoteTokenTotal.sub(e.quoteTokenFree)),c=(null===e||void 0===e?void 0:e.baseTokenFree)&&t.baseSplSizeToNumber(e.baseTokenFree),u=(null===e||void 0===e?void 0:e.quoteTokenFree)&&t.baseSplSizeToNumber(e.quoteTokenFree);r.push({marketName:l,market:t,coin:o,key:"".concat(l).concat(o),orders:n,unsettled:c,openOrders:e}),r.push({marketName:l,market:t,coin:i,key:"".concat(l).concat(i),orders:a,unsettled:u,openOrders:e})}))})),r}(),r=function(){var e=Z(),t=e.connected,n=e.wallet,r=y("customMarkets",[]),a=Object(s.a)(r,1)[0],c=R(),o=qe(),i=o&&o.map((function(e){return e.market})),d=i&&i.map((function(e){return e.address.toBase58()}));function m(){return(m=Object(u.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(i){e.next=4;break}return e.abrupt("return",null);case 4:return console.log("refreshing getOpenOrdersForDeprecatedMarkets"),r=function(){var e=Object(u.a)(l.a.mark((function e(t){var r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=he(t,a),o=r.marketName,e.prev=1,console.log("Fetching open orders for",o),e.next=5,t.loadOrdersForOwner(c,n.publicKey);case 5:return e.abrupt("return",e.sent.map((function(e){return Object(_.a)({marketName:o,market:t},e)})));case 8:return e.prev=8,e.t0=e.catch(1),console.log("Failed loading open orders",t.address.toBase58(),e.t0),Y({message:"Error loading open orders for deprecated ".concat(o),description:e.t0.message,type:"error"}),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),e.next=8,Promise.all(i.map(r));case 8:return e.abrupt("return",e.sent.filter((function(e){return e})).flat());case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f=Object(B.a)("getOpenOrdersForDeprecatedMarkets",t,c,n,d&&d.toString()),p=z((function(){return m.apply(this,arguments)}),f,{refreshInterval:ve}),b=Object(s.a)(p,2),v=b[0],k=b[1];return console.log("openOrders",v),{openOrders:v,loaded:k,refreshOpenOrders:function(){return N(f)}}}(),c=r.openOrders,o=r.loaded,i=r.refreshOpenOrders,d=pe().refresh,m=!c||c.length>0,f=n&&n.filter((function(e){var t=e.orders,n=e.unsettled;return t>0||n>0})),p=f&&f.length>0;return a.a.createElement(at,null,a.a.createElement(Kn,{level:4,style:{color:"rgba(255, 255, 255, 1)"}},"Migrate to new markets"),a.a.createElement(Je.a,null,"Serum has rolled out upgraded markets! They're faster and support fee discounts based on SRM holdings."),a.a.createElement("br",null),a.a.createElement(Je.a,null,"To migrate over to the new markets, please cancel your orders and settle your funds on old markets."),a.a.createElement("div",{style:{marginTop:20,display:"flex",justifyContent:"center"}},a.a.createElement(tt.a,{onClick:function(){return d(!0)}},a.a.createElement(qn.a,null)," Refresh data")),n?a.a.createElement(a.a.Fragment,null,a.a.createElement(nn.a,null,!m&&a.a.createElement(Fn.a,null)," Cancel your orders"),m?o?a.a.createElement(Jt,{openOrders:c,onCancelSuccess:function(){setTimeout((function(){d(),i()}),1e3)}}):a.a.createElement(Ue.a,{size:"large"}):null,a.a.createElement(nn.a,null,!p&&a.a.createElement(Fn.a,null)," Settle your funds"),p&&a.a.createElement(Dt,{balances:f,hideWalletBalance:!0,showMarket:!0,onSettleSuccess:function(){setTimeout(d,1e3)}}),a.a.createElement(nn.a,null,"Switch to upgraded markets"),a.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.a.createElement(tt.a,{onClick:t,disabled:p||m},"Switch to new markets"))):a.a.createElement(Ue.a,{size:"large"}))}var Ln=n(469),Dn=n(470),Wn=n(468),Un=Je.a.Text;function _n(e){var t,n,c,o,i=e.visible,l=e.onAddCustomMarket,u=e.onClose,d=R(),p=Object(r.useState)(null),b=Object(s.a)(p,2),v=b[0],k=b[1],h=Object(r.useState)(null===(t=H.MARKETS.find((function(e){return!e.deprecated})))||void 0===t||null===(n=t.programId)||void 0===n?void 0:n.toBase58()),g=Object(s.a)(h,2),y=g[0],O=g[1],E=Object(r.useState)(null),x=Object(s.a)(E,2),w=x[0],j=x[1],S=Object(r.useState)(null),T=Object(s.a)(S,2),C=T[0],A=T[1],M=Object(r.useState)(null),I=Object(s.a)(M,2),z=I[0],N=I[1],B=Object(r.useState)(null),F=Object(s.a)(B,2),P=F[0],q=F[1],K=Object(r.useState)(!1),L=Object(s.a)(K,2),D=L[0],W=L[1],U=f(v),_=f(y);Object(r.useEffect)((function(){U&&_?(W(!0),H.Market.load(d,new m.PublicKey(v),{},new m.PublicKey(y)).then((function(e){q(e)})).catch((function(){J(),q(null)})).finally((function(){return W(!1)}))):J()}),[d,v,y]);var J=function(){j(null),A(null),N(null)},Q=H.MARKETS.find((function(e){return e.address.toBase58()===v&&e.programId.toBase58()===y})),G=H.MARKETS.find((function(e){return e.programId.toBase58()===y})),X=(null===P||void 0===P?void 0:P.baseMintAddress)&&(null===(c=H.TOKEN_MINTS.find((function(e){return e.address.equals(P.baseMintAddress)})))||void 0===c?void 0:c.name),V=(null===P||void 0===P?void 0:P.quoteMintAddress)&&(null===(o=H.TOKEN_MINTS.find((function(e){return e.address.equals(P.quoteMintAddress)})))||void 0===o?void 0:o.name),Z=!D&&!!P&&v&&y&&w&&(X||C)&&(V||z)&&_&&U,$=function(){J(),q(null),k(null),O(null),u()};return a.a.createElement(rn.a,{title:"Add custom market",visible:i,onOk:function(){if(Z){var e={address:v,programId:y,name:w};X||(e.baseLabel=C),V||(e.quoteLabel=z),l(e),$()}else Y({message:"Please fill in all fields with valid values",type:"error"})},okText:"Add",onCancel:$,okButtonProps:{disabled:!Z}},a.a.createElement("div",null,U&&_?a.a.createElement(a.a.Fragment,null,!P&&a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement(Un,{type:"danger"},"Not a valid market and program ID combination")),P&&Q&&a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement(Un,{type:"warning"},"Market known: ",Q.name)),P&&!G&&a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement(Un,{type:"danger"},"Warning: unknown DEX program")),P&&G&&G.deprecated&&a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement(Un,{type:"warning"},"Warning: deprecated DEX program"))):a.a.createElement(a.a.Fragment,null,v&&!U&&a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement(Un,{type:"danger"},"Invalid market ID")),v&&!_&&a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement(Un,{type:"danger"},"Invalid program ID"))),a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement($e.a,{span:24},a.a.createElement(vn.a,{placeholder:"Market Id",value:v,onChange:function(e){return k(e.target.value)},suffix:D?a.a.createElement(Wn.a,null):null}))),y&&!f(y)&&a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement(Un,{type:"danger"},"Invalid program ID")),a.a.createElement(Ze.a,{style:{marginBottom:8}},a.a.createElement($e.a,{span:24},a.a.createElement(vn.a,{placeholder:"Program Id",value:y,onChange:function(e){return O(e.target.value)}}))),a.a.createElement(Ze.a,{style:{marginBottom:8,marginTop:8}},a.a.createElement($e.a,{span:24},a.a.createElement(vn.a,{placeholder:"Market Label",disabled:!P,value:w,onChange:function(e){return j(e.target.value)}}))),a.a.createElement(Ze.a,{gutter:[8],style:{marginBottom:8}},a.a.createElement($e.a,{span:12},a.a.createElement(vn.a,{placeholder:"Base label",disabled:!P||X,value:X||C,onChange:function(e){return A(e.target.value)}}),P&&!X&&a.a.createElement("div",{style:{marginTop:8}},a.a.createElement(Un,{type:"warning"},"Warning: unknown token"))),a.a.createElement($e.a,{span:12},a.a.createElement(vn.a,{placeholder:"Quote label",disabled:!P||V,value:V||z,onChange:function(e){return N(e.target.value)}}),P&&!V&&a.a.createElement("div",{style:{marginTop:8}},a.a.createElement(Un,{type:"warning"},"Warning: unknown token"))))))}function Hn(){var e=Object(Re.a)(["\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 16px 16px;\n  .borderNone .ant-select-selector {\n    border: none !important;\n  }\n"]);return Hn=function(){return e},e}var Jn=Ve.a.Option,Qn=Ve.a.OptGroup,Yn=Le.c.div(Hn());function Gn(){var e=ye(),t=e.market,n=e.marketName,c=e.customMarkets,o=e.setCustomMarkets,i=e.setMarketAddress,l=me.filter((function(e){return!e.deprecated})),u=Object(r.useState)(!1),d=Object(s.a)(u,2),m=d[0],f=d[1],p=Object(r.useState)(!1),b=Object(s.a)(p,2),v=b[0],k=b[1],h=qe(),g=Object(r.useState)({height:window.innerHeight,width:window.innerWidth}),y=Object(s.a)(g,2),O=y[0],x=y[1];Object(r.useEffect)((function(){document.title=n?"".concat(n," \u2014 Serum"):"Serum"}),[n]);var w=Object(r.useRef)();Object(r.useEffect)((function(){var e=function(){x({height:window.innerHeight,width:window.innerWidth})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var j=null===O||void 0===O?void 0:O.width,S={onChangeOrderRef:function(e){return w.current=e},onPrice:Object(r.useCallback)((function(e){return w.current&&w.current({price:e})}),[]),onSize:Object(r.useCallback)((function(e){return w.current&&w.current({size:e})}),[])},T=Object(r.useCallback)((function(){return m?a.a.createElement(Vn,{switchToLiveMarkets:function(){return f(!1)}}):j<1e3?a.a.createElement(er,S):j<1450?a.a.createElement($n,S):a.a.createElement(Zn,S)}),[j,S,m]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(_n,{visible:v,onClose:function(){return k(!1)},onAddCustomMarket:function(e){if(Ke(c).some((function(t){return t.address.toBase58()===e.address})))Y({message:"A market with the given ID already exists",type:"error"});else{var t=[].concat(Object(E.a)(c),[e]);o(t),i(e.address)}}}),a.a.createElement(Yn,null,a.a.createElement(Ze.a,{align:"middle",style:{paddingLeft:5,paddingRight:5},gutter:16},a.a.createElement($e.a,null,a.a.createElement(Xn,{markets:l,setHandleDeprecated:f,placeholder:"Select market",customMarkets:c,onDeleteCustomMarket:function(e){var t=c.filter((function(t){return t.address!==e}));o(t)}})),t?a.a.createElement($e.a,null,a.a.createElement(et.a,{content:a.a.createElement(Nn,{address:t.publicKey.toBase58()}),placement:"bottomRight",title:"Market address",trigger:"click"},a.a.createElement(Ln.a,{style:{color:"#2abdd2"}}))):null,a.a.createElement($e.a,null,a.a.createElement(Dn.a,{style:{color:"#2abdd2"},onClick:function(){return k(!0)}})),h&&h.length>0&&a.a.createElement(a.a.Fragment,null,a.a.createElement($e.a,null,a.a.createElement(Je.a,null,"You have unsettled funds on old markets! Please go through them to claim your funds.")),a.a.createElement($e.a,null,a.a.createElement(tt.a,{onClick:function(){return f(!m)}},m?"View new markets":"Handle old markets")))),T()))}function Xn(e){var t,n,r=e.markets,c=e.placeholder,o=e.setHandleDeprecated,i=e.customMarkets,l=e.onDeleteCustomMarket,u=ye(),s=u.market,d=u.setMarketAddress,m=function(e){return e.split("/")[0]},f=function(e){return e.split("/")[1]},p=null===(t=Ke(i).find((function(e){return(null===s||void 0===s?void 0:s.address)&&e.address.equals(s.address)})))||void 0===t||null===(n=t.address)||void 0===n?void 0:n.toBase58();return a.a.createElement(Ve.a,{showSearch:!0,size:"large",style:{width:200},placeholder:c||"Select a market",optionFilterProp:"name",onSelect:function(e){o(!1),d(e)},listHeight:400,value:p,filterOption:function(e,t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase().indexOf(e.toLowerCase()))>=0}},i&&i.length>0&&a.a.createElement(Qn,{label:"Custom"},i.map((function(e,t){var n=e.address,r=e.name;return a.a.createElement(Jn,{value:n,key:n,name:r,style:{padding:"10px",backgroundColor:t%2===0?"rgb(39, 44, 61)":null}},a.a.createElement(Ze.a,null,a.a.createElement($e.a,{flex:"auto"},r),p!==n&&a.a.createElement($e.a,null,a.a.createElement(Ut.a,{onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),l&&l(n)}}))))}))),a.a.createElement(Qn,{label:"Markets"},r.sort((function(e,t){return"USDT"===f(e.name)&&"USDT"!==f(t.name)?-1:"USDT"!==f(e.name)&&"USDT"===f(t.name)?1:0})).sort((function(e,t){return m(e.name)<m(t.name)?-1:m(e.name)>m(t.name)?1:0})).map((function(e,t){var n=e.address,r=e.name,c=e.deprecated;return a.a.createElement(Jn,{value:n.toBase58(),key:n,name:r,style:{padding:"10px",backgroundColor:t%2===0?"rgb(39, 44, 61)":null}},r," ",c?" (Deprecated)":null)}))))}var Vn=function(e){var t=e.switchToLiveMarkets;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ze.a,null,a.a.createElement($e.a,{flex:"auto"},a.a.createElement(Rn,{switchToLiveMarkets:t}))))},Zn=function(e){var t=e.onChangeOrderRef,n=e.onPrice,r=e.onSize;return a.a.createElement(Ze.a,{style:{minHeight:"800px",flexWrap:"nowrap"}},a.a.createElement($e.a,{flex:"auto",style:{height:"100%",display:"flex"}},a.a.createElement($t,null)),a.a.createElement($e.a,{flex:"360px",style:{height:"100%"}},a.a.createElement(gt,{smallScreen:!1,onPrice:n,onSize:r}),a.a.createElement(In,{smallScreen:!1})),a.a.createElement($e.a,{flex:"400px",style:{height:"100%",display:"flex",flexDirection:"column"}},a.a.createElement(wn,{setChangeOrderRef:t}),a.a.createElement(pn,null)))},$n=function(e){var t=e.onChangeOrderRef,n=e.onPrice,r=e.onSize;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ze.a,{style:{height:"800px"}},a.a.createElement($e.a,{flex:"auto",style:{height:"100%",display:"flex"}},a.a.createElement(gt,{smallScreen:!0,depth:13,onPrice:n,onSize:r})),a.a.createElement($e.a,{flex:"auto",style:{height:"100%",display:"flex"}},a.a.createElement(In,{smallScreen:!0})),a.a.createElement($e.a,{flex:"400px",style:{height:"100%",display:"flex",flexDirection:"column"}},a.a.createElement(wn,{setChangeOrderRef:t}),a.a.createElement(pn,null))),a.a.createElement(Ze.a,null,a.a.createElement($e.a,{flex:"auto"},a.a.createElement($t,null))))},er=function(e){var t=e.onChangeOrderRef,n=e.onPrice,r=e.onSize;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ze.a,null,a.a.createElement($e.a,{xs:24,sm:12,style:{height:"100%",display:"flex"}},a.a.createElement(wn,{style:{flex:1},setChangeOrderRef:t})),a.a.createElement($e.a,{xs:24,sm:12},a.a.createElement(pn,null))),a.a.createElement(Ze.a,{style:{height:"500px"}},a.a.createElement($e.a,{xs:24,sm:12,style:{height:"100%",display:"flex"}},a.a.createElement(gt,{smallScreen:!0,onPrice:n,onSize:r})),a.a.createElement($e.a,{xs:24,sm:12,style:{height:"100%",display:"flex"}},a.a.createElement(In,{smallScreen:!0}))),a.a.createElement(Ze.a,null,a.a.createElement($e.a,{flex:"auto"},a.a.createElement($t,null))))};function tr(){var e=function(){var e=Z(),t=e.connected,n=e.wallet,r=R(),a=fe();function c(){return(c=Object(u.a)(l.a.mark((function e(){var c,o,i,u,m,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=[],t){e.next=3;break}return e.abrupt("return",c);case 3:i=Object(d.a)(a),e.prev=4,m=l.a.mark((function e(){var t,a,i,d,m,f,p,b,v,k;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=u.value,a=(t=o).market,i=t.marketName,a){e.next=4;break}return e.abrupt("return",{v:c});case 4:return e.next=6,a.findOpenOrdersAccountsForOwner(r,n.publicKey);case 6:if(d=e.sent,m=d&&d[0]){e.next=10;break}return e.abrupt("return",{v:c});case 10:return e.next=12,Promise.all([a.loadBids(r),a.loadAsks(r)]);case 12:f=e.sent,p=Object(s.a)(f,2),b=p[0],v=p[1],k=[].concat(Object(E.a)(b),Object(E.a)(v)).filter((function(e){return e.openOrdersAddress.equals(m.publicKey)})).map((function(e){return Object(_.a)(Object(_.a)({},e),{},{marketName:i})})),c=c.concat(k);case 18:case"end":return e.stop()}}),e)})),i.s();case 7:if((u=i.n()).done){e.next=14;break}return e.delegateYield(m(),"t0",9);case 9:if("object"!==typeof(f=e.t0)){e.next=12;break}return e.abrupt("return",f.v);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(4),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return e.abrupt("return",c);case 23:case"end":return e.stop()}}),e,null,[[4,16,19,22]])})))).apply(this,arguments)}return z((function(){return c.apply(this,arguments)}),Object(B.a)("getOpenOrdersForAllMarkets",t,r,n,a),{refreshInterval:5e3})}(),t=Object(s.a)(e,1)[0];return a.a.createElement(at,{style:{flex:1,paddingTop:10}},a.a.createElement(Jt,{openOrders:t}))}function nr(e){var t=e.loaded,n=void 0!==t&&t,r=e.walletBalances;return a.a.createElement(wt,{emptyLabel:"No balances",dataSource:r,columns:[{title:"Coin",dataIndex:"key",key:"key"},{title:"Wallet Balance",dataIndex:"wallet",key:"wallet"}],pagination:!1,loading:!n})}function rr(e){var t=e.accountBalances,n=R(),r=Z().wallet;function c(){return(c=Object(u.a)(l.a.mark((function e(t){var a,c,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.market,c=t.openOrdersAccount,o=t.baseCurrencyAccount,i=t.quoteCurrencyAccount,e.next=3,Tt({market:a,openOrders:c,connection:n,wallet:r,baseCurrencyAccount:o,quoteCurrencyAccount:i});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var o=[{title:"Market",dataIndex:"key",key:"key"},{title:"Orders",dataIndex:"orders",key:"orders"},{title:"Unsettled",dataIndex:"unsettled",key:"unsettled"},{key:"action",render:function(e){return a.a.createElement("div",{style:{textAlign:"right"}},a.a.createElement(tt.a,{ghost:!0,style:{marginRight:12},onClick:function(){return function(e){return c.apply(this,arguments)}(e)}},"Settle"))}}];return a.a.createElement(wt,{emptyLabel:"No balances",dataSource:t,columns:o.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{key:"".concat(e.market).concat(e.coin)})})),pagination:!1})}var ar=Qt.a.TabPane;function cr(){var e=function(){var e=Z(),t=e.connected,n=e.wallet,r=R(),a=fe();function c(){return(c=Object(u.a)(l.a.mark((function e(){var c,o,i,u,s,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=[],t){e.next=3;break}return e.abrupt("return",c);case 3:i=Object(d.a)(a),e.prev=4,s=l.a.mark((function e(){var t,a,i,s,d,m,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=u.value,a=(t=o).market,i=t.marketName,a){e.next=4;break}return e.abrupt("return",{v:c});case 4:if(s=i.includes("/")&&i.split("/")[0],c.find((function(e){return e.coin===s}))){e.next=10;break}return e.next=8,Fe(a,r,n,!0);case 8:d=e.sent,c.push({key:s,coin:s,wallet:d});case 10:if(m=i.includes("/")&&i.split("/")[1],c.find((function(e){return e.coin===m}))){e.next=16;break}return e.next=14,Fe(a,r,n,!1);case 14:f=e.sent,c.push({key:m,coin:m,wallet:f});case 16:case"end":return e.stop()}}),e)})),i.s();case 7:if((u=i.n()).done){e.next=14;break}return e.delegateYield(s(),"t0",9);case 9:if("object"!==typeof(m=e.t0)){e.next=12;break}return e.abrupt("return",m.v);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(4),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return e.abrupt("return",c);case 23:case"end":return e.stop()}}),e,null,[[4,16,19,22]])})))).apply(this,arguments)}return z((function(){return c.apply(this,arguments)}),Object(B.a)("getWalletBalancesForAllMarkets",t,r,n,a),{refreshInterval:5e3})}(),t=Object(s.a)(e,2),n=t[0],r=t[1],c=function(){var e=Z(),t=e.connected,n=e.wallet,r=R(),a=fe();function c(){return(c=Object(u.a)(l.a.mark((function e(){var c,o,i,u,s,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=[],t){e.next=3;break}return e.abrupt("return",c);case 3:i=Object(d.a)(a),e.prev=4,s=l.a.mark((function e(){var t,a,i,s,d,m,f,p,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=u.value,a=(t=o).market,i=t.marketName,a){e.next=4;break}return e.abrupt("return",{v:c});case 4:return e.next=6,a.findOpenOrdersAccountsForOwner(r,n.publicKey);case 6:if(s=e.sent){e.next=9;break}return e.abrupt("return","continue");case 9:return e.next=11,a.findBaseTokenAccountsForOwner(r,n.publicKey);case 11:return d=e.sent,e.next=14,a.findQuoteTokenAccountsForOwner(r,n.publicKey);case 14:m=e.sent,f=i.includes("/")&&i.split("/")[0],p=i.includes("/")&&i.split("/")[1],b=[],s.forEach((function(e){var t=(null===e||void 0===e?void 0:e.baseTokenTotal)&&(null===e||void 0===e?void 0:e.baseTokenFree)&&a.baseSplSizeToNumber(e.baseTokenTotal.sub(e.baseTokenFree)),n=(null===e||void 0===e?void 0:e.quoteTokenTotal)&&(null===e||void 0===e?void 0:e.quoteTokenFree)&&a.baseSplSizeToNumber(e.quoteTokenTotal.sub(e.quoteTokenFree)),r=(null===e||void 0===e?void 0:e.baseTokenFree)&&a.baseSplSizeToNumber(e.baseTokenFree),c=(null===e||void 0===e?void 0:e.quoteTokenFree)&&a.baseSplSizeToNumber(e.quoteTokenFree);b.push({market:i,coin:f,key:f,orders:t,unsettled:r,openOrdersAccount:e,baseCurrencyAccount:d&&d[0],quoteCurrencyAccount:m&&m[0]}),b.push({market:i,coin:p,key:p,orders:n,unsettled:c,openOrdersAccount:e,baseCurrencyAccount:d&&d[0],quoteCurrencyAccount:m&&m[0]})})),c=c.concat(b);case 20:case"end":return e.stop()}}),e)})),i.s();case 7:if((u=i.n()).done){e.next=16;break}return e.delegateYield(s(),"t0",9);case 9:if("continue"!==(m=e.t0)){e.next=12;break}return e.abrupt("continue",14);case 12:if("object"!==typeof m){e.next=14;break}return e.abrupt("return",m.v);case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(4),i.e(e.t1);case 21:return e.prev=21,i.f(),e.finish(21);case 24:return e.abrupt("return",c);case 25:case"end":return e.stop()}}),e,null,[[4,18,21,24]])})))).apply(this,arguments)}return z((function(){return c.apply(this,arguments)}),Object(B.a)("getOpenOrderAccountsForAllMarkets",t,r,n,a),{refreshInterval:5e3})}(),o=Object(s.a)(c,2),i=o[0],m=o[1];return a.a.createElement(at,{style:{flex:1,paddingTop:10}},a.a.createElement(Qt.a,{defaultActiveKey:"walletBalances"},a.a.createElement(ar,{tab:"Wallet Balances",key:"walletBalances"},a.a.createElement(nr,{loaded:r,walletBalances:n})),a.a.createElement(ar,{tab:"Market balances",key:"marketBalances"},a.a.createElement(rr,{loaded:m,accountBalances:i}))))}var or=n(454),ir=n(471),lr=n(103),ur=n(255),sr=n.n(ur);function dr(){var e=Object(Re.a)(["\n  display: flex;\n  align-items: center;\n  color: #2abdd2;\n  font-weight: bold;\n  cursor: pointer;\n  img {\n    height: 30px;\n    margin-right: 8px;\n  }\n"]);return dr=function(){return e},e}function mr(){var e=Object(Re.a)(["\n  background-color: #0d1017;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  padding: 0px 30px;\n  flex-wrap: wrap;\n"]);return mr=function(){return e},e}var fr=Le.c.div(mr()),pr=Le.c.div(dr());function br(){var e,t=Object(r.useState)("/"),n=Object(s.a)(t,2),c=n[0],o=n[1],i=Z(),l=i.connected,u=i.wallet,d=i.providerUrl,m=i.setProvider,f=D(),p=f.endpoint,b=f.setEndpoint,v=Object(Xe.f)(),k=Object(Xe.e)(),h=null===u||void 0===u||null===(e=u.publicKey)||void 0===e?void 0:e.toBase58(),g=Object(r.useCallback)((function(e){k.push(e.key)}),[k]);return Object(r.useEffect)((function(){v.pathname.includes("/orders")?o("/orders"):v.pathname.includes("/balances")&&o("/balances")}),[v]),a.a.createElement(fr,null,a.a.createElement(pr,null,a.a.createElement("img",{src:sr.a,alt:""}),"SERUM"),a.a.createElement(lr.a,{mode:"horizontal",onClick:g,selectedKeys:[c],style:{borderBottom:"none",backgroundColor:"transparent",display:"flex",alignItems:"flex-end",flex:1}},a.a.createElement(lr.a.Item,{key:"/"},"TRADE")),a.a.createElement("div",null,a.a.createElement(Ve.a,{onSelect:b,value:p,style:{marginRight:8}},F.map((function(e){var t=e.name,n=e.endpoint;return a.a.createElement(Ve.a.Option,{value:n,key:n},t)})))),a.a.createElement("div",null,a.a.createElement(Ve.a,{onSelect:m,value:d},G.map((function(e){var t=e.name,n=e.url;return a.a.createElement(Ve.a.Option,{value:n,key:n},t)})))),a.a.createElement("div",null,a.a.createElement(tt.a,{type:"text",size:"large",onClick:l?u.disconnect:u.connect,style:{color:"#2abdd2"}},a.a.createElement(ir.a,null),l?"Disconnect":"Connect wallet"),l&&a.a.createElement(et.a,{content:a.a.createElement(Nn,{address:h}),placement:"bottomRight",title:"Wallet public key",trigger:"click"},a.a.createElement(Ln.a,{style:{color:"#2abdd2"}}))))}var vr=n(222),kr="https://discord.gg/MxZFT4v",hr="https://t.me/ProjectSerum",gr="https://github.com/project-serum",yr="https://projectserum.com/",Or="https://projectserum.com/developer-resources",Er="https://solanabeach.io",xr=or.a.Footer,wr=vr.a.useBreakpoint,jr=[{description:"Serum Developer Resources",link:Or},{description:"Discord",link:kr},{description:"Telegram",link:hr},{description:"GitHub",link:gr},{description:"Project Serum",link:yr},{description:"Solana Network",link:Er}],Sr=function(){var e=!wr().lg;return a.a.createElement(xr,{style:{height:"45px",paddingBottom:10,paddingTop:10}},a.a.createElement(Ze.a,{align:"middle",gutter:[16,4]},!e&&a.a.createElement(a.a.Fragment,null,a.a.createElement($e.a,{flex:"auto"}),jr.map((function(e,t){return a.a.createElement($e.a,{key:t+""},a.a.createElement(cn,{external:!0,to:e.link},e.description))}))),a.a.createElement($e.a,{flex:"auto"})))},Tr=or.a.Header,Cr=or.a.Content;function Ar(e){var t=e.children;return a.a.createElement(a.a.Fragment,null,a.a.createElement(or.a,{style:{display:"flex",minHeight:"100vh",flexDirection:"column"}},a.a.createElement(Tr,{style:{padding:0,minHeight:64,height:"unset"}},a.a.createElement(br,null)),a.a.createElement(Cr,{style:{flex:1}},t),a.a.createElement(Sr,null)))}function Mr(){return a.a.createElement(Ge.a,{basename:"/"},a.a.createElement(Xe.a,{exact:!0,path:"/",component:Ir}),a.a.createElement(Xe.a,{exact:!0,path:"/orders",component:zr}),a.a.createElement(Xe.a,{exact:!0,path:"/balances",component:Nr}))}function Ir(){return a.a.createElement(Ar,null,a.a.createElement(Gn,null))}function zr(){return a.a.createElement(Ar,null,a.a.createElement(tr,null))}function Nr(){return a.a.createElement(Ar,null,a.a.createElement(cr,null))}function Br(){return a.a.createElement(r.Suspense,{fallback:function(){return a.a.createElement(Ue.a,{size:"large"})}},a.a.createElement(We,null),a.a.createElement(Ye,null,a.a.createElement(K,null,a.a.createElement(ge,null,a.a.createElement(V,null,a.a.createElement(r.Suspense,{fallback:function(){return a.a.createElement(Ue.a,{size:"large"})}},a.a.createElement(Mr,null)))))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Br,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[262,1,2]]]);
//# sourceMappingURL=main.71a55720.chunk.js.map